--- branches/gtk-2-12/gdk/x11/gdkkeys-x11.c	2007/11/19 09:24:00	19002
+++ branches/gtk-2-12/gdk/x11/gdkkeys-x11.c	2008/06/17 02:13:46	20414
@@ -1661,7 +1661,7 @@
     {
       XkbDescRec *xkb = get_xkb (keymap_x11);
       
-      if (xkb->map->modmap[keycode] != 0)
+      if (xkb->map->modmap && xkb->map->modmap[keycode] != 0)
 	return TRUE;
     }
   else
